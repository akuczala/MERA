function out = ascend(w,v,u,wconj,vconj,uconj,h)

%Ascender %flipped output tensor correctly

tensors = {wconj,wconj,wconj,wconj,vconj,vconj,vconj,vconj,uconj,h,u,v,v,v,v,w,w,w,w};
links = { ...
{[1 2 3 4 5 -1 ],[6 7 8 9 10 -2 ],[11 12 13 14 15 -3 ],[16 17 18 19 20 -4 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[5 29 21 37 41 42 43 44 ],[44 38 39 40 45 46 47 48 ],[43 22 23 46 49 50 ],[25 26 48 28 51 52 ],[42 30 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 49 41 -5 ],[54 7 8 51 10 -6 ],[11 55 50 14 15 -7 ],[56 17 52 19 20 -8 ]}, ...
{[1 2 3 4 5 -1 ],[6 7 8 9 10 -2 ],[11 12 13 14 15 -3 ],[16 17 18 19 20 -4 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[21 37 22 39 41 42 43 44 ],[42 38 44 40 45 46 47 48 ],[41 43 23 46 49 50 ],[25 26 48 28 51 52 ],[29 30 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 49 5 -5 ],[54 7 8 51 10 -6 ],[11 55 50 14 15 -7 ],[56 17 52 19 20 -8 ]}, ...
{[1 2 3 4 5 -1 ],[6 7 8 9 10 -2 ],[11 12 13 14 15 -3 ],[16 17 18 19 20 -4 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[22 39 15 33 41 42 43 44 ],[37 38 42 40 45 46 47 48 ],[21 41 23 46 49 50 ],[25 26 48 28 51 52 ],[29 30 45 32 53 54 ],[44 34 35 47 55 56 ],[1 53 3 49 5 -5 ],[54 7 8 51 10 -6 ],[11 55 50 14 43 -7 ],[56 17 52 19 20 -8 ]}, ...
{[1 2 3 4 5 -1 ],[6 7 8 9 10 -2 ],[11 12 13 14 15 -3 ],[16 17 18 19 20 -4 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[29 30 37 38 41 42 43 44 ],[43 44 39 40 45 46 47 48 ],[21 22 23 46 49 50 ],[25 26 48 28 51 52 ],[41 42 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 49 5 -5 ],[54 7 8 51 10 -6 ],[11 55 50 14 15 -7 ],[56 17 52 19 20 -8 ]}, ...
{[1 2 3 4 5 -1 ],[6 7 8 9 10 -2 ],[11 12 13 14 15 -3 ],[16 17 18 19 20 -4 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[37 38 39 40 41 42 43 44 ],[41 42 43 44 45 46 47 48 ],[21 22 23 46 49 50 ],[25 26 48 28 51 52 ],[29 30 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 49 5 -5 ],[54 7 8 51 10 -6 ],[11 55 50 14 15 -7 ],[56 17 52 19 20 -8 ]}, ...
{[1 2 3 4 5 -1 ],[6 7 8 9 10 -2 ],[11 12 13 14 15 -3 ],[16 17 18 19 20 -4 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[39 40 33 34 41 42 43 44 ],[37 38 41 42 45 46 47 48 ],[21 22 23 46 49 50 ],[25 26 48 28 51 52 ],[29 30 45 32 53 54 ],[43 44 35 47 55 56 ],[1 53 3 49 5 -5 ],[54 7 8 51 10 -6 ],[11 55 50 14 15 -7 ],[56 17 52 19 20 -8 ]}, ...
{[1 2 3 4 5 -1 ],[6 7 8 9 10 -2 ],[11 12 13 14 15 -3 ],[16 17 18 19 20 -4 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[30 10 38 25 41 42 43 44 ],[37 43 39 40 45 46 47 48 ],[21 22 23 46 49 50 ],[44 26 48 28 51 52 ],[29 41 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 49 5 -5 ],[54 7 8 51 42 -6 ],[11 55 50 14 15 -7 ],[56 17 52 19 20 -8 ]}, ...
{[1 2 3 4 5 -1 ],[6 7 8 9 10 -2 ],[11 12 13 14 15 -3 ],[16 17 18 19 20 -4 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[38 25 40 26 41 42 43 44 ],[37 41 39 43 45 46 47 48 ],[21 22 23 46 49 50 ],[42 44 48 28 51 52 ],[29 30 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 49 5 -5 ],[54 7 8 51 10 -6 ],[11 55 50 14 15 -7 ],[56 17 52 19 20 -8 ]}, ...
{[1 2 3 4 5 -1 ],[6 7 8 9 10 -2 ],[11 12 13 14 15 -3 ],[16 17 18 19 20 -4 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[40 26 34 20 41 42 43 44 ],[37 38 39 41 45 46 47 48 ],[21 22 23 46 49 50 ],[25 42 48 28 51 52 ],[29 30 45 32 53 54 ],[33 43 35 47 55 56 ],[1 53 3 49 5 -5 ],[54 7 8 51 10 -6 ],[11 55 50 14 15 -7 ],[56 17 52 19 44 -8 ]}};

seqs = {[7 8 10 17 19 20 25 26 28 18 52 11 14 15 33 34 35 12 55 38 39 40 22 23 1 3 30 32 2 53 5 29 41 42 4 21 43 49 24 31 37 44 45 46 13 36 47 50 16 27 48 56 6 9 51 54], ...
    [1 3 5 7 8 10 29 30 32 6 54 17 19 20 25 26 28 18 52 11 14 15 33 34 35 12 55 41 43 21 22 23 42 44 46 24 37 38 39 40 13 36 47 50 16 27 48 56 9 31 45 51 2 4 49 53], ...
    [1 3 5 7 8 10 29 30 32 6 54 17 19 20 25 26 28 18 52 37 38 40 21 23 11 14 34 35 12 55 15 33 43 44 13 22 41 50 24 36 39 42 46 47 16 27 48 56 9 31 45 51 2 4 49 53], ...
    [1 3 5 11 14 15 21 22 23 13 50 17 19 20 33 34 35 16 56 7 8 10 25 26 28 9 51 41 42 29 30 32 43 44 45 31 37 38 39 40 6 27 48 54 18 36 47 52 12 24 46 55 2 4 49 53], ...
    [1 3 5 7 8 10 29 30 32 6 54 11 14 15 21 22 23 13 50 41 42 43 44 37 38 39 40 25 26 28 17 19 20 33 34 35 16 56 18 52 27 36 47 48 12 24 46 55 9 31 45 51 2 4 49 53], ...
    [1 3 5 7 8 10 29 30 32 6 54 11 14 15 21 22 23 13 50 17 19 20 25 26 28 18 52 43 44 33 34 35 41 42 47 36 37 38 39 40 16 27 48 56 12 24 46 55 9 31 45 51 2 4 49 53], ...
    [1 3 5 11 14 15 21 22 23 13 50 17 19 20 33 34 35 16 56 37 39 40 26 28 7 8 29 32 6 54 10 30 41 42 9 25 44 51 27 31 38 43 45 48 18 36 47 52 12 24 46 55 2 4 49 53], ...
    [1 3 5 7 8 10 29 30 32 6 54 11 14 15 21 22 23 13 50 17 19 20 33 34 35 16 56 42 44 25 26 28 41 43 48 27 37 38 39 40 18 36 47 52 12 24 46 55 9 31 45 51 2 4 49 53], ...
    [1 3 5 7 8 10 29 30 32 6 54 11 14 15 21 22 23 13 50 37 38 39 25 28 17 19 33 35 16 56 20 34 43 44 18 26 42 52 27 36 40 41 47 48 12 24 46 55 9 31 45 51 2 4 49 53]};

% links = { ...
% {[1 2 3 4 5 -5 ],[6 7 8 9 10 -6 ],[11 12 13 14 15 -7 ],[16 17 18 19 20 -8 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[5 29 21 37 41 42 43 44 ],[44 38 39 40 45 46 47 48 ],[43 22 23 46 49 50 ],[25 26 48 28 51 52 ],[42 30 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 49 41 -1 ],[54 7 8 51 10 -2 ],[11 55 50 14 15 -3 ],[56 17 52 19 20 -4 ]}, ...
% {[1 2 3 4 5 -5 ],[6 7 8 9 10 -6 ],[11 12 13 14 15 -7 ],[16 17 18 19 20 -8 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[21 37 22 39 41 42 43 44 ],[42 38 44 40 45 46 47 48 ],[41 43 23 46 49 50 ],[25 26 48 28 51 52 ],[29 30 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 49 5 -1 ],[54 7 8 51 10 -2 ],[11 55 50 14 15 -3 ],[56 17 52 19 20 -4 ]}, ...
% {[1 2 3 4 5 -5 ],[6 7 8 9 10 -6 ],[11 12 13 14 15 -7 ],[16 17 18 19 20 -8 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[22 39 15 33 41 42 43 44 ],[37 38 42 40 45 46 47 48 ],[21 41 23 46 49 50 ],[25 26 48 28 51 52 ],[29 30 45 32 53 54 ],[44 34 35 47 55 56 ],[1 53 3 49 5 -1 ],[54 7 8 51 10 -2 ],[11 55 50 14 43 -3 ],[56 17 52 19 20 -4 ]}, ...
% {[1 2 3 4 5 -5 ],[6 7 8 9 10 -6 ],[11 12 13 14 15 -7 ],[16 17 18 19 20 -8 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[29 30 37 38 41 42 43 44 ],[43 44 39 40 45 46 47 48 ],[21 22 23 46 49 50 ],[25 26 48 28 51 52 ],[41 42 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 49 5 -1 ],[54 7 8 51 10 -2 ],[11 55 50 14 15 -3 ],[56 17 52 19 20 -4 ]}, ...
% {[1 2 3 4 5 -5 ],[6 7 8 9 10 -6 ],[11 12 13 14 15 -7 ],[16 17 18 19 20 -8 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[37 38 39 40 41 42 43 44 ],[41 42 43 44 45 46 47 48 ],[21 22 23 46 49 50 ],[25 26 48 28 51 52 ],[29 30 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 49 5 -1 ],[54 7 8 51 10 -2 ],[11 55 50 14 15 -3 ],[56 17 52 19 20 -4 ]}, ...
% {[1 2 3 4 5 -5 ],[6 7 8 9 10 -6 ],[11 12 13 14 15 -7 ],[16 17 18 19 20 -8 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[39 40 33 34 41 42 43 44 ],[37 38 41 42 45 46 47 48 ],[21 22 23 46 49 50 ],[25 26 48 28 51 52 ],[29 30 45 32 53 54 ],[43 44 35 47 55 56 ],[1 53 3 49 5 -1 ],[54 7 8 51 10 -2 ],[11 55 50 14 15 -3 ],[56 17 52 19 20 -4 ]}, ...
% {[1 2 3 4 5 -5 ],[6 7 8 9 10 -6 ],[11 12 13 14 15 -7 ],[16 17 18 19 20 -8 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[30 10 38 25 41 42 43 44 ],[37 43 39 40 45 46 47 48 ],[21 22 23 46 49 50 ],[44 26 48 28 51 52 ],[29 41 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 49 5 -1 ],[54 7 8 51 42 -2 ],[11 55 50 14 15 -3 ],[56 17 52 19 20 -4 ]}, ...
% {[1 2 3 4 5 -5 ],[6 7 8 9 10 -6 ],[11 12 13 14 15 -7 ],[16 17 18 19 20 -8 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[38 25 40 26 41 42 43 44 ],[37 41 39 43 45 46 47 48 ],[21 22 23 46 49 50 ],[42 44 48 28 51 52 ],[29 30 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 49 5 -1 ],[54 7 8 51 10 -2 ],[11 55 50 14 15 -3 ],[56 17 52 19 20 -4 ]}, ...
% {[1 2 3 4 5 -5 ],[6 7 8 9 10 -6 ],[11 12 13 14 15 -7 ],[16 17 18 19 20 -8 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[40 26 34 20 41 42 43 44 ],[37 38 39 41 45 46 47 48 ],[21 22 23 46 49 50 ],[25 42 48 28 51 52 ],[29 30 45 32 53 54 ],[33 43 35 47 55 56 ],[1 53 3 49 5 -1 ],[54 7 8 51 10 -2 ],[11 55 50 14 15 -3 ],[56 17 52 19 44 -4 ]}};


dims = size(w);din = dims(1); dout = dims(length(dims));
out = zeros(dout,dout,dout,dout,dout,dout,dout,dout);
for j=1:length(links)
    out = out + ncon(tensors,links{j},seqs{j});
end
%DEBUG
%out = out/length(links);
%don't average - add