function [neww,newv,newu,newwconj,newvconj,newuconj] = updateMERA(w,v,u,wconj,vconj,uconj,h,r)
dims = size(w);din = dims(1); dout = dims(length(dims));
%u environment
uTensors = {wconj,wconj,wconj,wconj,vconj,vconj,vconj,vconj,uconj,h,v,v,v,v,w,w,w,w,r};
uLinks = { ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 -2 -3 -4 31 24 36 27 ],[5 29 21 37 41 42 43 -1 ],[43 22 23 -6 49 50 ],[25 26 -8 28 51 52 ],[42 30 -5 32 53 54 ],[33 34 35 -7 55 56 ],[1 53 3 49 41 57 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 -2 39 -4 31 24 36 27 ],[21 37 22 39 41 -1 43 -3 ],[41 43 23 -6 49 50 ],[25 26 -8 28 51 52 ],[29 30 -5 32 53 54 ],[33 34 35 -7 55 56 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[-1 -2 39 -4 31 24 36 27 ],[22 39 15 33 41 -3 43 44 ],[21 41 23 -6 49 50 ],[25 26 -8 28 51 52 ],[29 30 -5 32 53 54 ],[44 34 35 -7 55 56 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 55 50 14 43 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 -3 -4 31 24 36 27 ],[29 30 37 38 41 42 -1 -2 ],[21 22 23 -6 49 50 ],[25 26 -8 28 51 52 ],[41 42 -5 32 53 54 ],[33 34 35 -7 55 56 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[37 38 39 40 -1 -2 -3 -4 ],[21 22 23 -6 49 50 ],[25 26 -8 28 51 52 ],[29 30 -5 32 53 54 ],[33 34 35 -7 55 56 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[-1 -2 39 40 31 24 36 27 ],[39 40 33 34 -3 -4 43 44 ],[21 22 23 -6 49 50 ],[25 26 -8 28 51 52 ],[29 30 -5 32 53 54 ],[43 44 35 -7 55 56 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[-1 38 -3 -4 31 24 36 27 ],[30 10 38 25 41 42 -2 44 ],[21 22 23 -6 49 50 ],[44 26 -8 28 51 52 ],[29 41 -5 32 53 54 ],[33 34 35 -7 55 56 ],[1 53 3 49 5 57 ],[54 7 8 51 42 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[-1 38 -3 40 31 24 36 27 ],[38 25 40 26 -2 42 -4 44 ],[21 22 23 -6 49 50 ],[42 44 -8 28 51 52 ],[29 30 -5 32 53 54 ],[33 34 35 -7 55 56 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[-1 -2 -3 40 31 24 36 27 ],[40 26 34 20 -4 42 43 44 ],[21 22 23 -6 49 50 ],[25 42 -8 28 51 52 ],[29 30 -5 32 53 54 ],[33 43 35 -7 55 56 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 44 60 ],[57 58 59 60 61 62 63 64 ]}};

%v environment
vTensors = {wconj,wconj,wconj,wconj,vconj,vconj,vconj,vconj,uconj,h,u,v,v,v,w,w,w,w,r};
vLinks = { ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 -2 -3 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[5 29 21 37 41 42 -1 44 ],[44 38 39 40 45 -4 47 48 ],[25 26 48 28 51 52 ],[42 30 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 -5 41 57 ],[54 7 8 51 10 58 ],[11 55 -6 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 -3 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[21 37 22 39 -1 42 -2 44 ],[42 38 44 40 45 -4 47 48 ],[25 26 48 28 51 52 ],[29 30 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 -5 5 57 ],[54 7 8 51 10 58 ],[11 55 -6 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[-1 22 -3 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[22 39 15 33 -2 42 43 44 ],[37 38 42 40 45 -4 47 48 ],[25 26 48 28 51 52 ],[29 30 45 32 53 54 ],[44 34 35 47 55 56 ],[1 53 3 -5 5 57 ],[54 7 8 51 10 58 ],[11 55 -6 14 43 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[-1 -2 -3 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[29 30 37 38 41 42 43 44 ],[43 44 39 40 45 -4 47 48 ],[25 26 48 28 51 52 ],[41 42 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 -5 5 57 ],[54 7 8 51 10 58 ],[11 55 -6 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[-1 -2 -3 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[37 38 39 40 41 42 43 44 ],[41 42 43 44 45 -4 47 48 ],[25 26 48 28 51 52 ],[29 30 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 -5 5 57 ],[54 7 8 51 10 58 ],[11 55 -6 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[-1 -2 -3 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[39 40 33 34 41 42 43 44 ],[37 38 41 42 45 -4 47 48 ],[25 26 48 28 51 52 ],[29 30 45 32 53 54 ],[43 44 35 47 55 56 ],[1 53 3 -5 5 57 ],[54 7 8 51 10 58 ],[11 55 -6 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[-1 -2 -3 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[30 10 38 25 41 42 43 44 ],[37 43 39 40 45 -4 47 48 ],[44 26 48 28 51 52 ],[29 41 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 -5 5 57 ],[54 7 8 51 42 58 ],[11 55 -6 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[-1 -2 -3 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[38 25 40 26 41 42 43 44 ],[37 41 39 43 45 -4 47 48 ],[42 44 48 28 51 52 ],[29 30 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 -5 5 57 ],[54 7 8 51 10 58 ],[11 55 -6 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[-1 -2 -3 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[40 26 34 20 41 42 43 44 ],[37 38 39 41 45 -4 47 48 ],[25 42 48 28 51 52 ],[29 30 45 32 53 54 ],[33 43 35 47 55 56 ],[1 53 3 -5 5 57 ],[54 7 8 51 10 58 ],[11 55 -6 14 15 59 ],[56 17 52 19 44 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[-1 -2 27 -4 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[5 29 21 37 41 42 43 44 ],[44 38 39 40 45 46 47 -3 ],[43 22 23 46 49 50 ],[42 30 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 49 41 57 ],[54 7 8 -5 10 58 ],[11 55 50 14 15 59 ],[56 17 -6 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[-1 -2 27 -4 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[21 37 22 39 41 42 43 44 ],[42 38 44 40 45 46 47 -3 ],[41 43 23 46 49 50 ],[29 30 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 49 5 57 ],[54 7 8 -5 10 58 ],[11 55 50 14 15 59 ],[56 17 -6 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[-1 -2 27 -4 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[22 39 15 33 41 42 43 44 ],[37 38 42 40 45 46 47 -3 ],[21 41 23 46 49 50 ],[29 30 45 32 53 54 ],[44 34 35 47 55 56 ],[1 53 3 49 5 57 ],[54 7 8 -5 10 58 ],[11 55 50 14 43 59 ],[56 17 -6 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[-1 -2 27 -4 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[29 30 37 38 41 42 43 44 ],[43 44 39 40 45 46 47 -3 ],[21 22 23 46 49 50 ],[41 42 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 49 5 57 ],[54 7 8 -5 10 58 ],[11 55 50 14 15 59 ],[56 17 -6 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[-1 -2 27 -4 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[37 38 39 40 41 42 43 44 ],[41 42 43 44 45 46 47 -3 ],[21 22 23 46 49 50 ],[29 30 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 49 5 57 ],[54 7 8 -5 10 58 ],[11 55 50 14 15 59 ],[56 17 -6 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[-1 -2 27 -4 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[39 40 33 34 41 42 43 44 ],[37 38 41 42 45 46 47 -3 ],[21 22 23 46 49 50 ],[29 30 45 32 53 54 ],[43 44 35 47 55 56 ],[1 53 3 49 5 57 ],[54 7 8 -5 10 58 ],[11 55 50 14 15 59 ],[56 17 -6 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 -2 27 -4 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[30 10 38 25 41 42 43 -1 ],[37 43 39 40 45 46 47 -3 ],[21 22 23 46 49 50 ],[29 41 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 49 5 57 ],[54 7 8 -5 42 58 ],[11 55 50 14 15 59 ],[56 17 -6 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 -4 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[38 25 40 26 41 -1 43 -2 ],[37 41 39 43 45 46 47 -3 ],[21 22 23 46 49 50 ],[29 30 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 49 5 57 ],[54 7 8 -5 10 58 ],[11 55 50 14 15 59 ],[56 17 -6 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[-1 26 27 -4 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[40 26 34 20 41 -2 43 44 ],[37 38 39 41 45 46 47 -3 ],[21 22 23 46 49 50 ],[29 30 45 32 53 54 ],[33 43 35 47 55 56 ],[1 53 3 49 5 57 ],[54 7 8 -5 10 58 ],[11 55 50 14 15 59 ],[56 17 -6 19 44 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 -2 31 -4 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[5 29 21 37 41 -1 43 44 ],[44 38 39 40 -3 46 47 48 ],[43 22 23 46 49 50 ],[25 26 48 28 51 52 ],[33 34 35 47 55 56 ],[1 -5 3 49 41 57 ],[-6 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[-1 -2 31 -4 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[21 37 22 39 41 42 43 44 ],[42 38 44 40 -3 46 47 48 ],[41 43 23 46 49 50 ],[25 26 48 28 51 52 ],[33 34 35 47 55 56 ],[1 -5 3 49 5 57 ],[-6 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[-1 -2 31 -4 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[22 39 15 33 41 42 43 44 ],[37 38 42 40 -3 46 47 48 ],[21 41 23 46 49 50 ],[25 26 48 28 51 52 ],[44 34 35 47 55 56 ],[1 -5 3 49 5 57 ],[-6 7 8 51 10 58 ],[11 55 50 14 43 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 -4 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[29 30 37 38 -1 -2 43 44 ],[43 44 39 40 -3 46 47 48 ],[21 22 23 46 49 50 ],[25 26 48 28 51 52 ],[33 34 35 47 55 56 ],[1 -5 3 49 5 57 ],[-6 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[-1 -2 31 -4 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[37 38 39 40 41 42 43 44 ],[41 42 43 44 -3 46 47 48 ],[21 22 23 46 49 50 ],[25 26 48 28 51 52 ],[33 34 35 47 55 56 ],[1 -5 3 49 5 57 ],[-6 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[-1 -2 31 -4 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[39 40 33 34 41 42 43 44 ],[37 38 41 42 -3 46 47 48 ],[21 22 23 46 49 50 ],[25 26 48 28 51 52 ],[43 44 35 47 55 56 ],[1 -5 3 49 5 57 ],[-6 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[-1 30 31 -4 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[30 10 38 25 -2 42 43 44 ],[37 43 39 40 -3 46 47 48 ],[21 22 23 46 49 50 ],[44 26 48 28 51 52 ],[33 34 35 47 55 56 ],[1 -5 3 49 5 57 ],[-6 7 8 51 42 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[-1 -2 31 -4 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[38 25 40 26 41 42 43 44 ],[37 41 39 43 -3 46 47 48 ],[21 22 23 46 49 50 ],[42 44 48 28 51 52 ],[33 34 35 47 55 56 ],[1 -5 3 49 5 57 ],[-6 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[-1 -2 31 -4 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[40 26 34 20 41 42 43 44 ],[37 38 39 41 -3 46 47 48 ],[21 22 23 46 49 50 ],[25 42 48 28 51 52 ],[33 43 35 47 55 56 ],[1 -5 3 49 5 57 ],[-6 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 44 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[-1 -2 -3 36 12 16 ],[37 38 39 40 31 24 36 27 ],[5 29 21 37 41 42 43 44 ],[44 38 39 40 45 46 -4 48 ],[43 22 23 46 49 50 ],[25 26 48 28 51 52 ],[42 30 45 32 53 54 ],[1 53 3 49 41 57 ],[54 7 8 51 10 58 ],[11 -5 50 14 15 59 ],[-6 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[-1 -2 -3 36 12 16 ],[37 38 39 40 31 24 36 27 ],[21 37 22 39 41 42 43 44 ],[42 38 44 40 45 46 -4 48 ],[41 43 23 46 49 50 ],[25 26 48 28 51 52 ],[29 30 45 32 53 54 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 -5 50 14 15 59 ],[-6 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 -2 -3 36 12 16 ],[37 38 39 40 31 24 36 27 ],[22 39 15 33 41 42 43 -1 ],[37 38 42 40 45 46 -4 48 ],[21 41 23 46 49 50 ],[25 26 48 28 51 52 ],[29 30 45 32 53 54 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 -5 50 14 43 59 ],[-6 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[-1 -2 -3 36 12 16 ],[37 38 39 40 31 24 36 27 ],[29 30 37 38 41 42 43 44 ],[43 44 39 40 45 46 -4 48 ],[21 22 23 46 49 50 ],[25 26 48 28 51 52 ],[41 42 45 32 53 54 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 -5 50 14 15 59 ],[-6 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[-1 -2 -3 36 12 16 ],[37 38 39 40 31 24 36 27 ],[37 38 39 40 41 42 43 44 ],[41 42 43 44 45 46 -4 48 ],[21 22 23 46 49 50 ],[25 26 48 28 51 52 ],[29 30 45 32 53 54 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 -5 50 14 15 59 ],[-6 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 -3 36 12 16 ],[37 38 39 40 31 24 36 27 ],[39 40 33 34 41 42 -1 -2 ],[37 38 41 42 45 46 -4 48 ],[21 22 23 46 49 50 ],[25 26 48 28 51 52 ],[29 30 45 32 53 54 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 -5 50 14 15 59 ],[-6 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[-1 -2 -3 36 12 16 ],[37 38 39 40 31 24 36 27 ],[30 10 38 25 41 42 43 44 ],[37 43 39 40 45 46 -4 48 ],[21 22 23 46 49 50 ],[44 26 48 28 51 52 ],[29 41 45 32 53 54 ],[1 53 3 49 5 57 ],[54 7 8 51 42 58 ],[11 -5 50 14 15 59 ],[-6 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[-1 -2 -3 36 12 16 ],[37 38 39 40 31 24 36 27 ],[38 25 40 26 41 42 43 44 ],[37 41 39 43 45 46 -4 48 ],[21 22 23 46 49 50 ],[42 44 48 28 51 52 ],[29 30 45 32 53 54 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 -5 50 14 15 59 ],[-6 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[-1 34 -3 36 12 16 ],[37 38 39 40 31 24 36 27 ],[40 26 34 20 41 42 -2 44 ],[37 38 39 41 45 46 -4 48 ],[21 22 23 46 49 50 ],[25 42 48 28 51 52 ],[29 30 45 32 53 54 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 -5 50 14 15 59 ],[-6 17 52 19 44 60 ],[57 58 59 60 61 62 63 64 ]}};
%w environment
wTensors = {wconj,wconj,wconj,wconj,vconj,vconj,vconj,vconj,uconj,h,u,v,v,v,v,w,w,w,r};
wLinks = { ...
{[-1 2 -3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[5 29 21 37 -5 42 43 44 ],[44 38 39 40 45 46 47 48 ],[43 22 23 46 -4 50 ],[25 26 48 28 51 52 ],[42 30 45 32 -2 54 ],[33 34 35 47 55 56 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[-6 58 59 60 61 62 63 64 ]}, ...
{[-1 2 -3 4 -5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[21 37 22 39 41 42 43 44 ],[42 38 44 40 45 46 47 48 ],[41 43 23 46 -4 50 ],[25 26 48 28 51 52 ],[29 30 45 32 -2 54 ],[33 34 35 47 55 56 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[-6 58 59 60 61 62 63 64 ]}, ...
{[-1 2 -3 4 -5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[22 39 15 33 41 42 43 44 ],[37 38 42 40 45 46 47 48 ],[21 41 23 46 -4 50 ],[25 26 48 28 51 52 ],[29 30 45 32 -2 54 ],[44 34 35 47 55 56 ],[54 7 8 51 10 58 ],[11 55 50 14 43 59 ],[56 17 52 19 20 60 ],[-6 58 59 60 61 62 63 64 ]}, ...
{[-1 2 -3 4 -5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[29 30 37 38 41 42 43 44 ],[43 44 39 40 45 46 47 48 ],[21 22 23 46 -4 50 ],[25 26 48 28 51 52 ],[41 42 45 32 -2 54 ],[33 34 35 47 55 56 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[-6 58 59 60 61 62 63 64 ]}, ...
{[-1 2 -3 4 -5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[37 38 39 40 41 42 43 44 ],[41 42 43 44 45 46 47 48 ],[21 22 23 46 -4 50 ],[25 26 48 28 51 52 ],[29 30 45 32 -2 54 ],[33 34 35 47 55 56 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[-6 58 59 60 61 62 63 64 ]}, ...
{[-1 2 -3 4 -5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[39 40 33 34 41 42 43 44 ],[37 38 41 42 45 46 47 48 ],[21 22 23 46 -4 50 ],[25 26 48 28 51 52 ],[29 30 45 32 -2 54 ],[43 44 35 47 55 56 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[-6 58 59 60 61 62 63 64 ]}, ...
{[-1 2 -3 4 -5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[30 10 38 25 41 42 43 44 ],[37 43 39 40 45 46 47 48 ],[21 22 23 46 -4 50 ],[44 26 48 28 51 52 ],[29 41 45 32 -2 54 ],[33 34 35 47 55 56 ],[54 7 8 51 42 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[-6 58 59 60 61 62 63 64 ]}, ...
{[-1 2 -3 4 -5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[38 25 40 26 41 42 43 44 ],[37 41 39 43 45 46 47 48 ],[21 22 23 46 -4 50 ],[42 44 48 28 51 52 ],[29 30 45 32 -2 54 ],[33 34 35 47 55 56 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[-6 58 59 60 61 62 63 64 ]}, ...
{[-1 2 -3 4 -5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[40 26 34 20 41 42 43 44 ],[37 38 39 41 45 46 47 48 ],[21 22 23 46 -4 50 ],[25 42 48 28 51 52 ],[29 30 45 32 -2 54 ],[33 43 35 47 55 56 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 44 60 ],[-6 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 -2 -3 9 -5 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[5 29 21 37 41 42 43 44 ],[44 38 39 40 45 46 47 48 ],[43 22 23 46 49 50 ],[25 26 48 28 -4 52 ],[42 30 45 32 53 -1 ],[33 34 35 47 55 56 ],[1 53 3 49 41 57 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 -6 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 -2 -3 9 -5 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[21 37 22 39 41 42 43 44 ],[42 38 44 40 45 46 47 48 ],[41 43 23 46 49 50 ],[25 26 48 28 -4 52 ],[29 30 45 32 53 -1 ],[33 34 35 47 55 56 ],[1 53 3 49 5 57 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 -6 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 -2 -3 9 -5 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[22 39 15 33 41 42 43 44 ],[37 38 42 40 45 46 47 48 ],[21 41 23 46 49 50 ],[25 26 48 28 -4 52 ],[29 30 45 32 53 -1 ],[44 34 35 47 55 56 ],[1 53 3 49 5 57 ],[11 55 50 14 43 59 ],[56 17 52 19 20 60 ],[57 -6 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 -2 -3 9 -5 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[29 30 37 38 41 42 43 44 ],[43 44 39 40 45 46 47 48 ],[21 22 23 46 49 50 ],[25 26 48 28 -4 52 ],[41 42 45 32 53 -1 ],[33 34 35 47 55 56 ],[1 53 3 49 5 57 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 -6 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 -2 -3 9 -5 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[37 38 39 40 41 42 43 44 ],[41 42 43 44 45 46 47 48 ],[21 22 23 46 49 50 ],[25 26 48 28 -4 52 ],[29 30 45 32 53 -1 ],[33 34 35 47 55 56 ],[1 53 3 49 5 57 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 -6 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 -2 -3 9 -5 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[39 40 33 34 41 42 43 44 ],[37 38 41 42 45 46 47 48 ],[21 22 23 46 49 50 ],[25 26 48 28 -4 52 ],[29 30 45 32 53 -1 ],[43 44 35 47 55 56 ],[1 53 3 49 5 57 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 -6 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 -2 -3 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[30 10 38 25 41 -5 43 44 ],[37 43 39 40 45 46 47 48 ],[21 22 23 46 49 50 ],[44 26 48 28 -4 52 ],[29 41 45 32 53 -1 ],[33 34 35 47 55 56 ],[1 53 3 49 5 57 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 -6 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 -2 -3 9 -5 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[38 25 40 26 41 42 43 44 ],[37 41 39 43 45 46 47 48 ],[21 22 23 46 49 50 ],[42 44 48 28 -4 52 ],[29 30 45 32 53 -1 ],[33 34 35 47 55 56 ],[1 53 3 49 5 57 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 -6 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 -2 -3 9 -5 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[40 26 34 20 41 42 43 44 ],[37 38 39 41 45 46 47 48 ],[21 22 23 46 49 50 ],[25 42 48 28 -4 52 ],[29 30 45 32 53 -1 ],[33 43 35 47 55 56 ],[1 53 3 49 5 57 ],[11 55 50 14 15 59 ],[56 17 52 19 44 60 ],[57 -6 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[-1 12 13 -4 -5 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[5 29 21 37 41 42 43 44 ],[44 38 39 40 45 46 47 48 ],[43 22 23 46 49 -3 ],[25 26 48 28 51 52 ],[42 30 45 32 53 54 ],[33 34 35 47 -2 56 ],[1 53 3 49 41 57 ],[54 7 8 51 10 58 ],[56 17 52 19 20 60 ],[57 58 -6 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[-1 12 13 -4 -5 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[21 37 22 39 41 42 43 44 ],[42 38 44 40 45 46 47 48 ],[41 43 23 46 49 -3 ],[25 26 48 28 51 52 ],[29 30 45 32 53 54 ],[33 34 35 47 -2 56 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[56 17 52 19 20 60 ],[57 58 -6 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[-1 12 13 -4 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[22 39 15 33 41 42 -5 44 ],[37 38 42 40 45 46 47 48 ],[21 41 23 46 49 -3 ],[25 26 48 28 51 52 ],[29 30 45 32 53 54 ],[44 34 35 47 -2 56 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[56 17 52 19 20 60 ],[57 58 -6 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[-1 12 13 -4 -5 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[29 30 37 38 41 42 43 44 ],[43 44 39 40 45 46 47 48 ],[21 22 23 46 49 -3 ],[25 26 48 28 51 52 ],[41 42 45 32 53 54 ],[33 34 35 47 -2 56 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[56 17 52 19 20 60 ],[57 58 -6 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[-1 12 13 -4 -5 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[37 38 39 40 41 42 43 44 ],[41 42 43 44 45 46 47 48 ],[21 22 23 46 49 -3 ],[25 26 48 28 51 52 ],[29 30 45 32 53 54 ],[33 34 35 47 -2 56 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[56 17 52 19 20 60 ],[57 58 -6 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[-1 12 13 -4 -5 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[39 40 33 34 41 42 43 44 ],[37 38 41 42 45 46 47 48 ],[21 22 23 46 49 -3 ],[25 26 48 28 51 52 ],[29 30 45 32 53 54 ],[43 44 35 47 -2 56 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[56 17 52 19 20 60 ],[57 58 -6 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[-1 12 13 -4 -5 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[30 10 38 25 41 42 43 44 ],[37 43 39 40 45 46 47 48 ],[21 22 23 46 49 -3 ],[44 26 48 28 51 52 ],[29 41 45 32 53 54 ],[33 34 35 47 -2 56 ],[1 53 3 49 5 57 ],[54 7 8 51 42 58 ],[56 17 52 19 20 60 ],[57 58 -6 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[-1 12 13 -4 -5 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[38 25 40 26 41 42 43 44 ],[37 41 39 43 45 46 47 48 ],[21 22 23 46 49 -3 ],[42 44 48 28 51 52 ],[29 30 45 32 53 54 ],[33 34 35 47 -2 56 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[56 17 52 19 20 60 ],[57 58 -6 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[-1 12 13 -4 -5 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[40 26 34 20 41 42 43 44 ],[37 38 39 41 45 46 47 48 ],[21 22 23 46 49 -3 ],[25 42 48 28 51 52 ],[29 30 45 32 53 54 ],[33 43 35 47 -2 56 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[56 17 52 19 44 60 ],[57 58 -6 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 -2 18 -4 -5 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[5 29 21 37 41 42 43 44 ],[44 38 39 40 45 46 47 48 ],[43 22 23 46 49 50 ],[25 26 48 28 51 -3 ],[42 30 45 32 53 54 ],[33 34 35 47 55 -1 ],[1 53 3 49 41 57 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[57 58 59 -6 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 -2 18 -4 -5 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[21 37 22 39 41 42 43 44 ],[42 38 44 40 45 46 47 48 ],[41 43 23 46 49 50 ],[25 26 48 28 51 -3 ],[29 30 45 32 53 54 ],[33 34 35 47 55 -1 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[57 58 59 -6 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 -2 18 -4 -5 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[22 39 15 33 41 42 43 44 ],[37 38 42 40 45 46 47 48 ],[21 41 23 46 49 50 ],[25 26 48 28 51 -3 ],[29 30 45 32 53 54 ],[44 34 35 47 55 -1 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 55 50 14 43 59 ],[57 58 59 -6 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 -2 18 -4 -5 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[29 30 37 38 41 42 43 44 ],[43 44 39 40 45 46 47 48 ],[21 22 23 46 49 50 ],[25 26 48 28 51 -3 ],[41 42 45 32 53 54 ],[33 34 35 47 55 -1 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[57 58 59 -6 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 -2 18 -4 -5 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[37 38 39 40 41 42 43 44 ],[41 42 43 44 45 46 47 48 ],[21 22 23 46 49 50 ],[25 26 48 28 51 -3 ],[29 30 45 32 53 54 ],[33 34 35 47 55 -1 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[57 58 59 -6 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 -2 18 -4 -5 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[39 40 33 34 41 42 43 44 ],[37 38 41 42 45 46 47 48 ],[21 22 23 46 49 50 ],[25 26 48 28 51 -3 ],[29 30 45 32 53 54 ],[43 44 35 47 55 -1 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[57 58 59 -6 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 -2 18 -4 -5 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[30 10 38 25 41 42 43 44 ],[37 43 39 40 45 46 47 48 ],[21 22 23 46 49 50 ],[44 26 48 28 51 -3 ],[29 41 45 32 53 54 ],[33 34 35 47 55 -1 ],[1 53 3 49 5 57 ],[54 7 8 51 42 58 ],[11 55 50 14 15 59 ],[57 58 59 -6 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 -2 18 -4 -5 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[38 25 40 26 41 42 43 44 ],[37 41 39 43 45 46 47 48 ],[21 22 23 46 49 50 ],[42 44 48 28 51 -3 ],[29 30 45 32 53 54 ],[33 34 35 47 55 -1 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[57 58 59 -6 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 -2 18 -4 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 38 39 40 31 24 36 27 ],[40 26 34 20 41 42 43 -5 ],[37 38 39 41 45 46 47 48 ],[21 22 23 46 49 50 ],[25 42 48 28 51 -3 ],[29 30 45 32 53 54 ],[33 43 35 47 55 -1 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[57 58 59 -6 61 62 63 64 ]}};

uSeqs = {[22 23 1 3 30 32 2 53 5 29 41 42 4 21 43 49 7 8 10 25 26 28 9 51 11 14 15 17 19 20 33 34 35 16 56 12 55 59 60 63 64 18 52 58 62 6 13 50 54 57 61 24 27 31 36 37],...
    [41 43 21 22 23 1 3 5 29 30 32 2 53 7 8 10 25 26 28 9 51 11 14 15 17 19 20 33 34 35 16 56 12 55 59 60 63 64 18 52 58 62 6 54 57 61 27 31 36 4 13 24 37 39 49 50],...
    [21 23 11 14 34 35 12 55 15 33 43 44 13 22 41 50 1 3 5 29 30 32 2 53 7 8 10 17 19 20 25 26 28 18 52 9 51 58 60 62 64 6 54 57 61 4 16 49 56 59 63 24 27 31 36 39],...
    [41 42 29 30 32 1 3 5 21 22 23 4 49 7 8 10 25 26 28 9 51 11 14 15 17 19 20 33 34 35 16 56 12 55 59 60 63 64 18 52 58 62 13 50 57 61 24 27 36 2 6 31 37 38 53 54],...
    [21 22 23 1 3 5 29 30 32 2 53 7 8 10 25 26 28 9 51 11 14 15 17 19 20 33 34 35 16 56 12 55 59 60 63 64 18 52 58 62 6 54 57 61 4 13 49 50 24 27 31 36 37 38 39 40],...
    [43 44 33 34 35 11 14 15 21 22 23 13 50 1 3 5 29 30 32 2 53 7 8 10 17 19 20 25 26 28 18 52 9 51 58 60 62 64 6 54 57 61 4 49 59 63 24 27 31 12 16 36 39 40 55 56],...
    [26 28 7 8 29 32 6 54 10 30 41 42 9 25 44 51 1 3 5 21 22 23 4 49 11 14 15 17 19 20 33 34 35 16 56 12 55 59 60 63 64 13 50 57 61 2 18 52 53 58 62 24 27 31 36 38],...
    [42 44 25 26 28 7 8 10 29 30 32 6 54 1 3 5 21 22 23 4 49 11 14 15 17 19 20 33 34 35 16 56 12 55 59 60 63 64 13 50 57 61 2 53 58 62 24 31 36 9 18 27 38 40 51 52],...
    [25 28 17 19 33 35 16 56 20 34 43 44 18 26 42 52 7 8 10 29 30 32 6 54 1 3 5 11 14 15 21 22 23 13 50 4 49 57 59 61 63 2 53 58 62 9 12 51 55 60 64 24 27 31 36 40]};

vSeqs = {[1 3 30 32 38 39 40 7 8 10 25 26 28 9 51 11 14 15 17 19 20 33 34 35 16 56 12 55 59 60 63 64 18 52 58 62 27 36 47 48 6 31 45 54 2 53 57 61 5 29 37 41 42 44 4 13 21 24], ...
[1 3 5 29 30 32 2 53 7 8 10 25 26 28 9 51 11 14 15 17 19 20 33 34 35 16 56 12 55 59 60 63 64 18 52 58 62 6 54 57 61 45 47 48 27 31 36 38 40 4 13 24 21 22 37 39 42 44], ...
[11 14 34 35 37 38 40 1 3 5 29 30 32 2 53 7 8 10 17 19 20 25 26 28 18 52 9 51 58 60 62 64 6 54 57 61 27 31 45 48 16 36 47 56 12 55 59 63 15 33 39 42 43 44 4 13 22 24], ...
[1 3 5 11 14 15 17 19 20 33 34 35 16 56 7 8 10 25 26 28 9 51 41 42 29 30 32 43 44 45 31 37 38 39 40 6 27 48 54 18 36 47 52 58 60 62 64 12 55 59 63 2 53 57 61 4 13 24], ...
[1 3 5 11 14 15 7 8 10 29 30 32 6 54 41 42 43 44 37 38 39 40 25 26 28 17 19 20 33 34 35 16 56 18 52 27 36 47 48 9 31 45 51 58 60 62 64 12 55 59 63 2 53 57 61 4 13 24], ...
[1 3 5 11 14 15 7 8 10 29 30 32 6 54 17 19 20 25 26 28 18 52 43 44 33 34 35 41 42 47 36 37 38 39 40 16 27 48 56 9 31 45 51 58 60 62 64 12 55 59 63 2 53 57 61 4 13 24], ...
[1 3 5 11 14 15 17 19 20 33 34 35 16 56 37 39 40 26 28 7 8 29 32 6 54 10 30 41 42 9 25 44 51 27 31 38 43 45 48 18 36 47 52 58 60 62 64 12 55 59 63 2 53 57 61 4 13 24], ...
[1 3 5 11 14 15 7 8 10 29 30 32 6 54 17 19 20 33 34 35 16 56 42 44 25 26 28 41 43 48 27 37 38 39 40 18 36 47 52 9 31 45 51 58 60 62 64 12 55 59 63 2 53 57 61 4 13 24], ...
[1 3 5 11 14 15 7 8 10 29 30 32 6 54 37 38 39 25 28 17 19 33 35 16 56 20 34 43 44 18 26 42 52 27 36 40 41 47 48 9 31 45 51 58 60 62 64 12 55 59 63 2 53 57 61 4 13 24], ...
[7 8 10 17 19 20 11 14 15 33 34 35 12 55 38 39 40 22 23 1 3 30 32 2 53 5 29 41 42 4 21 43 49 24 31 37 44 45 46 13 36 47 50 57 59 61 63 16 56 60 64 6 54 58 62 9 18 27], ...
[7 8 10 17 19 20 1 3 5 29 30 32 2 53 11 14 15 33 34 35 12 55 41 43 21 22 23 42 44 46 24 37 38 39 40 13 36 47 50 4 31 45 49 57 59 61 63 16 56 60 64 6 54 58 62 9 18 27], ...
[7 8 10 17 19 20 1 3 5 29 30 32 2 53 37 38 40 21 23 11 14 34 35 12 55 15 33 43 44 13 22 41 50 24 36 39 42 46 47 4 31 45 49 57 59 61 63 16 56 60 64 6 54 58 62 9 18 27], ...
[7 8 10 17 19 20 11 14 15 33 34 35 12 55 1 3 5 21 22 23 4 49 41 42 29 30 32 43 44 45 31 37 38 39 40 2 24 46 53 13 36 47 50 57 59 61 63 16 56 60 64 6 54 58 62 9 18 27], ...
[7 8 10 17 19 20 1 3 5 29 30 32 2 53 41 42 43 44 37 38 39 40 21 22 23 11 14 15 33 34 35 12 55 13 50 24 36 46 47 4 31 45 49 57 59 61 63 16 56 60 64 6 54 58 62 9 18 27], ...
[7 8 10 17 19 20 1 3 5 29 30 32 2 53 11 14 15 21 22 23 13 50 43 44 33 34 35 41 42 47 36 37 38 39 40 12 24 46 55 4 31 45 49 57 59 61 63 16 56 60 64 6 54 58 62 9 18 27], ...
[7 8 29 32 37 39 40 1 3 5 21 22 23 4 49 11 14 15 17 19 20 33 34 35 16 56 12 55 59 60 63 64 13 50 57 61 24 36 46 47 2 31 45 53 6 54 58 62 10 30 38 41 42 43 9 18 25 27], ...
[7 8 10 29 30 32 6 54 1 3 5 21 22 23 4 49 11 14 15 17 19 20 33 34 35 16 56 12 55 59 60 63 64 13 50 57 61 2 53 58 62 45 46 47 24 31 36 37 39 9 18 27 25 26 38 40 41 43], ...
[17 19 33 35 37 38 39 7 8 10 29 30 32 6 54 1 3 5 11 14 15 21 22 23 13 50 4 49 57 59 61 63 2 53 58 62 24 31 45 46 12 36 47 55 16 56 60 64 20 34 40 41 43 44 9 18 26 27], ...
[1 3 22 23 38 39 40 7 8 10 25 26 28 9 51 11 14 15 17 19 20 33 34 35 16 56 12 55 59 60 63 64 18 52 58 62 27 36 47 48 13 24 46 50 4 49 57 61 5 21 37 41 43 44 2 6 29 31], ...
[1 3 5 7 8 10 17 19 20 25 26 28 18 52 11 14 15 33 34 35 12 55 41 43 21 22 23 42 44 46 24 37 38 39 40 13 36 47 50 16 27 48 56 59 60 63 64 9 51 58 62 4 49 57 61 2 6 31], ...
[1 3 5 7 8 10 17 19 20 25 26 28 18 52 37 38 40 21 23 11 14 34 35 12 55 15 33 43 44 13 22 41 50 24 36 39 42 46 47 16 27 48 56 59 60 63 64 9 51 58 62 4 49 57 61 2 6 31], ...
[1 3 5 21 22 23 4 49 7 8 10 25 26 28 9 51 11 14 15 17 19 20 33 34 35 16 56 12 55 59 60 63 64 18 52 58 62 13 50 57 61 46 47 48 24 27 36 39 40 2 6 31 29 30 37 38 43 44], ...
[1 3 5 7 8 10 11 14 15 21 22 23 13 50 41 42 43 44 37 38 39 40 25 26 28 17 19 20 33 34 35 16 56 18 52 27 36 47 48 12 24 46 55 59 60 63 64 9 51 58 62 4 49 57 61 2 6 31], ...
[1 3 5 7 8 10 11 14 15 21 22 23 13 50 17 19 20 25 26 28 18 52 43 44 33 34 35 41 42 47 36 37 38 39 40 16 27 48 56 12 24 46 55 59 60 63 64 9 51 58 62 4 49 57 61 2 6 31], ...
[7 8 26 28 37 39 40 1 3 5 21 22 23 4 49 11 14 15 17 19 20 33 34 35 16 56 12 55 59 60 63 64 13 50 57 61 24 36 46 47 18 27 48 52 9 51 58 62 10 25 38 42 43 44 2 6 30 31], ...
[1 3 5 7 8 10 11 14 15 21 22 23 13 50 17 19 20 33 34 35 16 56 42 44 25 26 28 41 43 48 27 37 38 39 40 18 36 47 52 12 24 46 55 59 60 63 64 9 51 58 62 4 49 57 61 2 6 31], ...
[1 3 5 7 8 10 11 14 15 21 22 23 13 50 37 38 39 25 28 17 19 33 35 16 56 20 34 43 44 18 26 42 52 27 36 40 41 47 48 12 24 46 55 59 60 63 64 9 51 58 62 4 49 57 61 2 6 31], ...
[11 14 15 17 19 20 7 8 10 25 26 28 9 51 38 39 40 22 23 1 3 30 32 2 53 5 29 41 42 4 21 43 49 24 31 37 44 45 46 6 27 48 54 57 58 61 62 18 52 60 64 13 50 59 63 12 16 36], ...
[11 14 15 17 19 20 7 8 10 25 26 28 9 51 1 3 5 29 30 32 2 53 41 43 21 22 23 42 44 46 24 37 38 39 40 4 31 45 49 6 27 48 54 57 58 61 62 18 52 60 64 13 50 59 63 12 16 36], ...
[11 14 21 23 37 38 40 1 3 5 29 30 32 2 53 7 8 10 17 19 20 25 26 28 18 52 9 51 58 60 62 64 6 54 57 61 27 31 45 48 4 24 46 49 13 50 59 63 15 22 39 41 42 43 12 16 33 36], ...
[11 14 15 17 19 20 1 3 5 21 22 23 4 49 7 8 10 25 26 28 9 51 41 42 29 30 32 43 44 45 31 37 38 39 40 6 27 48 54 2 24 46 53 57 58 61 62 18 52 60 64 13 50 59 63 12 16 36], ...
[11 14 15 17 19 20 1 3 5 21 22 23 4 49 41 42 43 44 37 38 39 40 25 26 28 7 8 10 29 30 32 6 54 9 51 27 31 45 48 2 24 46 53 57 58 61 62 18 52 60 64 13 50 59 63 12 16 36], ...
[11 14 15 21 22 23 13 50 1 3 5 29 30 32 2 53 7 8 10 17 19 20 25 26 28 18 52 9 51 58 60 62 64 6 54 57 61 4 49 59 63 45 46 48 24 27 31 37 38 12 16 36 33 34 39 40 41 42], ...
[11 14 15 17 19 20 1 3 5 21 22 23 4 49 37 39 40 26 28 7 8 29 32 6 54 10 30 41 42 9 25 44 51 27 31 38 43 45 48 2 24 46 53 57 58 61 62 18 52 60 64 13 50 59 63 12 16 36], ...
[11 14 15 17 19 20 1 3 5 21 22 23 4 49 7 8 10 29 30 32 6 54 42 44 25 26 28 41 43 48 27 37 38 39 40 9 31 45 51 2 24 46 53 57 58 61 62 18 52 60 64 13 50 59 63 12 16 36], ...
[17 19 25 28 37 38 39 7 8 10 29 30 32 6 54 1 3 5 11 14 15 21 22 23 13 50 4 49 57 59 61 63 2 53 58 62 24 31 45 46 9 27 48 51 18 52 60 64 20 26 40 41 42 44 12 16 34 36]};

wSeqs = {[22 23 30 32 38 39 40 7 8 10 25 26 28 9 51 11 14 15 17 19 20 33 34 35 16 56 12 55 59 60 63 64 18 52 58 62 27 36 47 48 6 31 45 54 13 24 46 50 21 29 37 42 43 44 2 4 5 61], ...
[7 8 10 29 30 32 6 54 17 19 20 25 26 28 18 52 11 14 15 33 34 35 12 55 41 43 21 22 23 42 44 46 24 37 38 39 40 13 36 47 50 16 27 48 56 9 31 45 51 58 59 60 62 63 64 2 4 61], ...
[7 8 10 29 30 32 6 54 17 19 20 25 26 28 18 52 37 38 40 21 23 11 14 34 35 12 55 15 33 43 44 13 22 41 50 24 36 39 42 46 47 16 27 48 56 9 31 45 51 58 59 60 62 63 64 2 4 61], ...
[11 14 15 21 22 23 13 50 17 19 20 33 34 35 16 56 7 8 10 25 26 28 9 51 41 42 29 30 32 43 44 45 31 37 38 39 40 6 27 48 54 18 36 47 52 12 24 46 55 58 59 60 62 63 64 2 4 61], ...
[7 8 10 29 30 32 6 54 11 14 15 21 22 23 13 50 41 42 43 44 37 38 39 40 25 26 28 17 19 20 33 34 35 16 56 18 52 27 36 47 48 12 24 46 55 9 31 45 51 58 59 60 62 63 64 2 4 61], ...
[7 8 10 29 30 32 6 54 11 14 15 21 22 23 13 50 17 19 20 25 26 28 18 52 43 44 33 34 35 41 42 47 36 37 38 39 40 16 27 48 56 12 24 46 55 9 31 45 51 58 59 60 62 63 64 2 4 61], ...
[11 14 15 21 22 23 13 50 17 19 20 33 34 35 16 56 37 39 40 26 28 7 8 29 32 6 54 10 30 41 42 9 25 44 51 27 31 38 43 45 48 18 36 47 52 12 24 46 55 58 59 60 62 63 64 2 4 61], ...
[7 8 10 29 30 32 6 54 11 14 15 21 22 23 13 50 17 19 20 33 34 35 16 56 42 44 25 26 28 41 43 48 27 37 38 39 40 18 36 47 52 12 24 46 55 9 31 45 51 58 59 60 62 63 64 2 4 61], ...
[7 8 10 29 30 32 6 54 11 14 15 21 22 23 13 50 37 38 39 25 28 17 19 33 35 16 56 20 34 43 44 18 26 42 52 27 36 40 41 47 48 12 24 46 55 9 31 45 51 58 59 60 62 63 64 2 4 61], ...
[17 19 20 25 26 28 18 52 11 14 15 33 34 35 12 55 38 39 40 22 23 1 3 30 32 2 53 5 29 41 42 4 21 43 49 24 31 37 44 45 46 13 36 47 50 16 27 48 56 57 59 60 61 63 64 6 9 62], ...
[1 3 5 29 30 32 2 53 17 19 20 25 26 28 18 52 11 14 15 33 34 35 12 55 41 43 21 22 23 42 44 46 24 37 38 39 40 13 36 47 50 16 27 48 56 4 31 45 49 57 59 60 61 63 64 6 9 62], ...
[1 3 5 29 30 32 2 53 17 19 20 25 26 28 18 52 37 38 40 21 23 11 14 34 35 12 55 15 33 43 44 13 22 41 50 24 36 39 42 46 47 16 27 48 56 4 31 45 49 57 59 60 61 63 64 6 9 62], ...
[17 19 20 25 26 28 18 52 11 14 15 33 34 35 12 55 1 3 5 21 22 23 4 49 41 42 29 30 32 43 44 45 31 37 38 39 40 2 24 46 53 13 36 47 50 16 27 48 56 57 59 60 61 63 64 6 9 62], ...
[1 3 5 29 30 32 2 53 11 14 15 21 22 23 13 50 41 42 43 44 37 38 39 40 25 26 28 17 19 20 33 34 35 16 56 18 52 27 36 47 48 12 24 46 55 4 31 45 49 57 59 60 61 63 64 6 9 62], ...
[1 3 5 29 30 32 2 53 11 14 15 21 22 23 13 50 17 19 20 25 26 28 18 52 43 44 33 34 35 41 42 47 36 37 38 39 40 16 27 48 56 12 24 46 55 4 31 45 49 57 59 60 61 63 64 6 9 62], ...
[26 28 29 32 37 39 40 1 3 5 21 22 23 4 49 11 14 15 17 19 20 33 34 35 16 56 12 55 59 60 63 64 13 50 57 61 24 36 46 47 2 31 45 53 18 27 48 52 25 30 38 41 43 44 6 9 10 62], ...
[1 3 5 29 30 32 2 53 11 14 15 21 22 23 13 50 17 19 20 33 34 35 16 56 42 44 25 26 28 41 43 48 27 37 38 39 40 18 36 47 52 12 24 46 55 4 31 45 49 57 59 60 61 63 64 6 9 62], ...
[1 3 5 29 30 32 2 53 11 14 15 21 22 23 13 50 37 38 39 25 28 17 19 33 35 16 56 20 34 43 44 18 26 42 52 27 36 40 41 47 48 12 24 46 55 4 31 45 49 57 59 60 61 63 64 6 9 62], ...
[17 19 20 33 34 35 16 56 7 8 10 25 26 28 9 51 38 39 40 22 23 1 3 30 32 2 53 5 29 41 42 4 21 43 49 24 31 37 44 45 46 6 27 48 54 18 36 47 52 57 58 60 61 62 64 12 13 63], ...
[17 19 20 33 34 35 16 56 7 8 10 25 26 28 9 51 1 3 5 29 30 32 2 53 41 43 21 22 23 42 44 46 24 37 38 39 40 4 31 45 49 6 27 48 54 18 36 47 52 57 58 60 61 62 64 12 13 63], ...
[21 23 34 35 37 38 40 1 3 5 29 30 32 2 53 7 8 10 17 19 20 25 26 28 18 52 9 51 58 60 62 64 6 54 57 61 27 31 45 48 16 36 47 56 4 24 46 49 22 33 39 41 42 44 12 13 15 63], ...
[1 3 5 21 22 23 4 49 17 19 20 33 34 35 16 56 7 8 10 25 26 28 9 51 41 42 29 30 32 43 44 45 31 37 38 39 40 6 27 48 54 18 36 47 52 2 24 46 53 57 58 60 61 62 64 12 13 63], ...
[1 3 5 21 22 23 4 49 7 8 10 29 30 32 6 54 41 42 43 44 37 38 39 40 25 26 28 17 19 20 33 34 35 16 56 18 52 27 36 47 48 9 31 45 51 2 24 46 53 57 58 60 61 62 64 12 13 63], ...
[1 3 5 21 22 23 4 49 7 8 10 29 30 32 6 54 17 19 20 25 26 28 18 52 43 44 33 34 35 41 42 47 36 37 38 39 40 16 27 48 56 9 31 45 51 2 24 46 53 57 58 60 61 62 64 12 13 63], ...
[1 3 5 21 22 23 4 49 17 19 20 33 34 35 16 56 37 39 40 26 28 7 8 29 32 6 54 10 30 41 42 9 25 44 51 27 31 38 43 45 48 18 36 47 52 2 24 46 53 57 58 60 61 62 64 12 13 63], ...
[1 3 5 21 22 23 4 49 7 8 10 29 30 32 6 54 17 19 20 33 34 35 16 56 42 44 25 26 28 41 43 48 27 37 38 39 40 18 36 47 52 9 31 45 51 2 24 46 53 57 58 60 61 62 64 12 13 63], ...
[1 3 5 21 22 23 4 49 7 8 10 29 30 32 6 54 37 38 39 25 28 17 19 33 35 16 56 20 34 43 44 18 26 42 52 27 36 40 41 47 48 9 31 45 51 2 24 46 53 57 58 60 61 62 64 12 13 63], ...
[7 8 10 25 26 28 9 51 11 14 15 33 34 35 12 55 38 39 40 22 23 1 3 30 32 2 53 5 29 41 42 4 21 43 49 24 31 37 44 45 46 13 36 47 50 6 27 48 54 57 58 59 61 62 63 16 18 64], ...
[7 8 10 25 26 28 9 51 1 3 5 29 30 32 2 53 11 14 15 33 34 35 12 55 41 43 21 22 23 42 44 46 24 37 38 39 40 13 36 47 50 4 31 45 49 6 27 48 54 57 58 59 61 62 63 16 18 64], ...
[7 8 10 25 26 28 9 51 1 3 5 29 30 32 2 53 37 38 40 21 23 11 14 34 35 12 55 15 33 43 44 13 22 41 50 24 36 39 42 46 47 4 31 45 49 6 27 48 54 57 58 59 61 62 63 16 18 64], ...
[7 8 10 25 26 28 9 51 11 14 15 33 34 35 12 55 1 3 5 21 22 23 4 49 41 42 29 30 32 43 44 45 31 37 38 39 40 2 24 46 53 13 36 47 50 6 27 48 54 57 58 59 61 62 63 16 18 64], ...
[7 8 10 25 26 28 9 51 1 3 5 29 30 32 2 53 41 42 43 44 37 38 39 40 21 22 23 11 14 15 33 34 35 12 55 13 50 24 36 46 47 4 31 45 49 6 27 48 54 57 58 59 61 62 63 16 18 64], ...
[7 8 10 25 26 28 9 51 1 3 5 29 30 32 2 53 11 14 15 21 22 23 13 50 43 44 33 34 35 41 42 47 36 37 38 39 40 12 24 46 55 4 31 45 49 6 27 48 54 57 58 59 61 62 63 16 18 64], ...
[11 14 15 33 34 35 12 55 1 3 5 21 22 23 4 49 37 39 40 26 28 7 8 29 32 6 54 10 30 41 42 9 25 44 51 27 31 38 43 45 48 2 24 46 53 13 36 47 50 57 58 59 61 62 63 16 18 64], ...
[11 14 15 33 34 35 12 55 1 3 5 21 22 23 4 49 7 8 10 29 30 32 6 54 42 44 25 26 28 41 43 48 27 37 38 39 40 9 31 45 51 2 24 46 53 13 36 47 50 57 58 59 61 62 63 16 18 64], ...
[25 28 33 35 37 38 39 7 8 10 29 30 32 6 54 1 3 5 11 14 15 21 22 23 13 50 4 49 57 59 61 63 2 53 58 62 24 31 45 46 12 36 47 55 9 27 48 51 26 34 40 41 42 43 16 18 20 64]};

%calculate u env diagrams (9)
env = zeros(din,din,din,din,din,din,din,din);

parfor j = 1:length(uLinks)
    env = env + ncon(uTensors,uLinks{j},uSeqs{j});
end


%SVD u environment to get new u
envMat = reshape(env,din^4,din^4);
[U,S,V] = svd(envMat,'econ');
%disp(max(max(UpuMat - U*S*ctranspose(V))));

S(S ~= 0) = 1;
newu = U*S*ctranspose(V); %don't transpose - order of indices takes care of this
newu = conj(newu); %removing this seemed to improve energy ratio of first to 0th
%layer
newu = reshape(newu,din,din,din,din,din,din,din,din);
newu = -newu;
newuconj = conj(newu);

%calculate v env diagrams (9*4)
env = zeros(din,din,din,din,din,din);

parfor j = 1:length(vLinks)
    env = env + ncon(vTensors,vLinks{j},vSeqs{j});
end


%SVD v environment to get new v
envMat = reshape(env,din^4,din^2);
[U,S,V] = svd(envMat,'econ');
%disp(max(max(UpuMat - U*S*ctranspose(V))));

S(S ~= 0) = 1;
newv = U*S*ctranspose(V); %don't transpose - order of indices takes care of this
newv = conj(newv); %removing this seemed to improve energy ratio of first to 0th
%layer
newv = reshape(newv,din,din,din,din,din,din);
newv = -newv;
newvconj = conj(newv);

%calculate w env diagrams (9*4)
env = zeros(din,din,din,din,din,dout);

parfor j = 1:length(wLinks)
    env = env + ncon(wTensors,wLinks{j},wSeqs{j});
end

%SVD w environment to get new w
envMat = reshape(env,din^5,dout);
[U,S,V] = svd(envMat,'econ');
%disp(max(max(UpuMat - U*S*ctranspose(V))));

S(S ~= 0) = 1;
neww = U*S*ctranspose(V); %don't transpose - order of indices takes care of this
neww = conj(neww); %removing this seemed to improve energy ratio of first to 0th
%layer
neww = reshape(neww,din,din,din,din,din,dout);
neww = -neww;
newwconj = conj(neww);

end
