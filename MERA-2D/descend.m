function out = descend(w,v,u,wconj,vconj,uconj,r)
%Descender
tensors = {wconj,wconj,wconj,wconj,vconj,vconj,vconj,vconj,uconj,u,v,v,v,v,w,w,w,w,r};

%flipped output tensor correctly
links = { ...
{[1 2 3 4 -5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[-7 22 23 24 4 13 ],[25 26 27 28 9 18 ],[-6 30 31 32 2 6 ],[33 34 35 36 12 16 ],[-8 38 39 40 31 24 36 27 ],[-4 38 39 40 45 46 47 48 ],[-3 22 23 46 49 50 ],[25 26 48 28 51 52 ],[-2 30 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 49 -1 57 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[-5 -7 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[-6 38 -8 40 31 24 36 27 ],[-2 38 -4 40 45 46 47 48 ],[-1 -3 23 46 49 50 ],[25 26 48 28 51 52 ],[29 30 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 -7 63 ],[16 17 18 19 20 64 ],[21 -5 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[-8 34 35 36 12 16 ],[37 38 -6 40 31 24 36 27 ],[37 38 -2 40 45 46 47 48 ],[21 -1 23 46 49 50 ],[25 26 48 28 51 52 ],[29 30 45 32 53 54 ],[-4 34 35 47 55 56 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 55 50 14 -3 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[-5 -6 31 32 2 6 ],[33 34 35 36 12 16 ],[-7 -8 39 40 31 24 36 27 ],[-3 -4 39 40 45 46 47 48 ],[21 22 23 46 49 50 ],[25 26 48 28 51 52 ],[-1 -2 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[-5 -6 -7 -8 31 24 36 27 ],[-1 -2 -3 -4 45 46 47 48 ],[21 22 23 46 49 50 ],[25 26 48 28 51 52 ],[29 30 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[-7 -8 35 36 12 16 ],[37 38 -5 -6 31 24 36 27 ],[37 38 -1 -2 45 46 47 48 ],[21 22 23 46 49 50 ],[25 26 48 28 51 52 ],[29 30 45 32 53 54 ],[-3 -4 35 47 55 56 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 -6 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[-8 26 27 28 9 18 ],[29 -5 31 32 2 6 ],[33 34 35 36 12 16 ],[37 -7 39 40 31 24 36 27 ],[37 -3 39 40 45 46 47 48 ],[21 22 23 46 49 50 ],[-4 26 48 28 51 52 ],[29 -1 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 49 5 57 ],[54 7 8 51 -2 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[-6 -8 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 -5 39 -7 31 24 36 27 ],[37 -1 39 -3 45 46 47 48 ],[21 22 23 46 49 50 ],[-2 -4 48 28 51 52 ],[29 30 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
{[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 -8 64 ],[21 22 23 24 4 13 ],[25 -6 27 28 9 18 ],[29 30 31 32 2 6 ],[33 -7 35 36 12 16 ],[37 38 39 -5 31 24 36 27 ],[37 38 39 -1 45 46 47 48 ],[21 22 23 46 49 50 ],[25 -2 48 28 51 52 ],[29 30 45 32 53 54 ],[33 -3 35 47 55 56 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 -4 60 ],[57 58 59 60 61 62 63 64 ]}};

% links = { ...
% {[1 2 3 4 -1 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[-3 22 23 24 4 13 ],[25 26 27 28 9 18 ],[-2 30 31 32 2 6 ],[33 34 35 36 12 16 ],[-4 38 39 40 31 24 36 27 ],[-8 38 39 40 45 46 47 48 ],[-7 22 23 46 49 50 ],[25 26 48 28 51 52 ],[-6 30 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 49 -5 57 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
% {[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[-1 -3 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[-2 38 -4 40 31 24 36 27 ],[-6 38 -8 40 45 46 47 48 ],[-5 -7 23 46 49 50 ],[25 26 48 28 51 52 ],[29 30 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
% {[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 -3 63 ],[16 17 18 19 20 64 ],[21 -1 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[-4 34 35 36 12 16 ],[37 38 -2 40 31 24 36 27 ],[37 38 -6 40 45 46 47 48 ],[21 -5 23 46 49 50 ],[25 26 48 28 51 52 ],[29 30 45 32 53 54 ],[-8 34 35 47 55 56 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 55 50 14 -7 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
% {[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[-1 -2 31 32 2 6 ],[33 34 35 36 12 16 ],[-3 -4 39 40 31 24 36 27 ],[-7 -8 39 40 45 46 47 48 ],[21 22 23 46 49 50 ],[25 26 48 28 51 52 ],[-5 -6 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
% {[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[-1 -2 -3 -4 31 24 36 27 ],[-5 -6 -7 -8 45 46 47 48 ],[21 22 23 46 49 50 ],[25 26 48 28 51 52 ],[29 30 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
% {[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[25 26 27 28 9 18 ],[29 30 31 32 2 6 ],[-3 -4 35 36 12 16 ],[37 38 -1 -2 31 24 36 27 ],[37 38 -5 -6 45 46 47 48 ],[21 22 23 46 49 50 ],[25 26 48 28 51 52 ],[29 30 45 32 53 54 ],[-7 -8 35 47 55 56 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
% {[1 2 3 4 5 61 ],[6 7 8 9 -2 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[-4 26 27 28 9 18 ],[29 -1 31 32 2 6 ],[33 34 35 36 12 16 ],[37 -3 39 40 31 24 36 27 ],[37 -7 39 40 45 46 47 48 ],[21 22 23 46 49 50 ],[-8 26 48 28 51 52 ],[29 -5 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 49 5 57 ],[54 7 8 51 -6 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
% {[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 20 64 ],[21 22 23 24 4 13 ],[-2 -4 27 28 9 18 ],[29 30 31 32 2 6 ],[33 34 35 36 12 16 ],[37 -1 39 -3 31 24 36 27 ],[37 -5 39 -7 45 46 47 48 ],[21 22 23 46 49 50 ],[-6 -8 48 28 51 52 ],[29 30 45 32 53 54 ],[33 34 35 47 55 56 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 20 60 ],[57 58 59 60 61 62 63 64 ]}, ...
% {[1 2 3 4 5 61 ],[6 7 8 9 10 62 ],[11 12 13 14 15 63 ],[16 17 18 19 -4 64 ],[21 22 23 24 4 13 ],[25 -2 27 28 9 18 ],[29 30 31 32 2 6 ],[33 -3 35 36 12 16 ],[37 38 39 -1 31 24 36 27 ],[37 38 39 -5 45 46 47 48 ],[21 22 23 46 49 50 ],[25 -6 48 28 51 52 ],[29 30 45 32 53 54 ],[33 -7 35 47 55 56 ],[1 53 3 49 5 57 ],[54 7 8 51 10 58 ],[11 55 50 14 15 59 ],[56 17 52 19 -8 60 ],[57 58 59 60 61 62 63 64 ]}};

seqs = {[1 3 22 23 30 32 38 39 40 7 8 10 25 26 28 9 51 11 14 15 17 19 20 33 34 35 16 56 12 55 59 60 63 64 18 52 58 62 27 36 47 48 6 31 45 54 13 24 46 50 2 4 49 53 57 61], ...
    [1 3 5 29 30 32 2 53 7 8 10 25 26 28 9 51 11 14 15 17 19 20 33 34 35 16 56 12 55 59 60 63 64 18 52 58 62 6 54 57 61 45 47 48 27 31 36 38 40 46 49 50 4 13 23 24], ...
    [11 14 21 23 34 35 37 38 40 1 3 5 29 30 32 2 53 7 8 10 17 19 20 25 26 28 18 52 9 51 58 60 62 64 6 54 57 61 27 31 45 48 16 36 47 56 4 24 46 49 12 13 50 55 59 63], ...
    [1 3 5 21 22 23 4 49 7 8 10 25 26 28 9 51 11 14 15 17 19 20 33 34 35 16 56 12 55 59 60 63 64 18 52 58 62 13 50 57 61 46 47 48 24 27 36 39 40 45 53 54 2 6 31 32], ...
    [21 22 23 1 3 5 29 30 32 2 53 7 8 10 25 26 28 9 51 11 14 15 17 19 20 33 34 35 16 56 12 55 59 60 63 64 18 52 58 62 6 54 57 61 4 13 49 50 45 46 47 48 24 27 31 36], ...
    [11 14 15 21 22 23 13 50 1 3 5 29 30 32 2 53 7 8 10 17 19 20 25 26 28 18 52 9 51 58 60 62 64 6 54 57 61 4 49 59 63 45 46 48 24 27 31 37 38 47 55 56 12 16 35 36], ...
    [7 8 26 28 29 32 37 39 40 1 3 5 21 22 23 4 49 11 14 15 17 19 20 33 34 35 16 56 12 55 59 60 63 64 13 50 57 61 24 36 46 47 2 31 45 53 18 27 48 52 6 9 51 54 58 62], ...
    [7 8 10 29 30 32 6 54 1 3 5 21 22 23 4 49 11 14 15 17 19 20 33 34 35 16 56 12 55 59 60 63 64 13 50 57 61 2 53 58 62 45 46 47 24 31 36 37 39 48 51 52 9 18 27 28], ...
    [17 19 25 28 33 35 37 38 39 7 8 10 29 30 32 6 54 1 3 5 11 14 15 21 22 23 13 50 4 49 57 59 61 63 2 53 58 62 24 31 45 46 12 36 47 55 9 27 48 51 16 18 52 56 60 64]};
dims = size(w);din = dims(1); dout = dims(length(dims));
out = zeros(din,din,din,din,din,din,din,din);
for j=1:length(links)
    out = out + ncon(tensors,links{j},seqs{j});
end
out = out/length(links);